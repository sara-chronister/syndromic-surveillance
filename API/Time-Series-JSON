# Use the keyring package to authenticate username and password

get_ts_json <- function(url) {
  api_response <- GET(url, authenticate(key_list("essence")[1,2],
                                          key_get("essence",key_list("essence")[1,2])))
  api_response_json <- content(api_response, as = "text")
  api_data <- fromJSON(api_response_json)
  timeseries_data <- api_data$timeSeriesData 
  timeseries_data <- timeseries_data %>% select(-altText, -details) %>%
    mutate(date = as.Date(date))
  return(timeseries_data)
}
